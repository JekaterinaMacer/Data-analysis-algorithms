# Data analysis algorithms

Урок 3. Логистическая регрессия. Log Loss


##  Summary

* Логистическая регрессия - частный случай линейной классификации - предсказывает вероятность отнесения объекта к основному классу, что зачастую очень важно при интерпретации
* Для "отображения" действительных предсказаний линейной модели в "вероятностный" интервал [0,1] применяют сигмоиду
* Для обучения логистической регрессии используют логарифмическую функцию потерь (log-loss), полученную методом максимального правдоподобия (maximum likelihood estimation)
* Оптимизируем log-loss классическим градиентным спуском, в котором берем градиент log-loss'а
* Основными метриками качества классификатора являются Accuracy, Precision, Recall, ROC-AUC, PR-AUC, F-мера
* Нужно быть внимательным при работе с этими метриками и хорошо понимать, как они работают и как между собой связаны, иначе выводы могут получиться неверными

### Опеределения
*Масштабирование данных*

**Классификация** — задача, в которой имеется множество объектов, разделённых некоторым образом на классы.

**Линейный классификатор** — алгоритм классификации, основанный на построении линейной разделяющей поверхности.

**Отступ (для классификатора)** — эвристика, оценивающая то, насколько объект принадлежит классу, насколько эталонным представителем он является.
____________
_Логистическая регрессия_

**Логистическая регрессия** — метод построения линейного классификатора, позволяющий оценивать апостериорные вероятности принадлежности объектов классам.

**Риск** – отношение вероятности «положительный эффект» к вероятности «отрицательный эффект».

**Логит** – натуральный логарифм отношения вероятности «положительный эффект» к вероятности «отрицательный эффект».
____________
_Метрики качества классификации_

**Accuracy** – доля правильных ответов.

$$accuracy(a,x) = \frac{1}{l} \sum^{l}_{i=1}[a(x_{i})=y_{i}].$$

**Точность (precision)** – долю истинных срабатываний от общего количества срабатываний.

$$precision(a, X) = \frac{TP}{TP+FP}.$$

**Полнота (recall)** – доля объектов, истинно относящихся к выбранному классу, которые алгоритм отнес к этому классу.

$$recall(a, X) = \frac{TP}{TP+FN},$$

**F-мера** – среднее гармоническое между точностью и полнотой.

$$F_{\beta} = (1 + \beta^{2}) \frac{precision \cdot recall}{\beta^{2} \cdot precision + recall}.$$

**ROC-кривая** (receiver operating characteristic) — график, позволяющий оценить качество бинарной классификации, отображает соотношение между долей объектов от общего количества носителей признака, верно классифицированных как несущие признак (TPR), и долей объектов от общего количества объектов, не несущих признака, ошибочно классифицированных как несущие признак (FPR) при варьировании порога решающего правила.

**PR-кривая** — график, позволяющий оценить качество бинарной классификации, отображает соотношение между Precision и Recall.
